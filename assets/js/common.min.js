!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e="undefined"!=typeof globalThis?globalThis:e||self)}(this,(function(e){"use strict";const{Array:t,Object:r,String:s,Number:a,Blob:n,File:i,ArrayBuffer:o,Uint8Array:c,Function:l,Boolean:p,Promise:u,FormData:d,URL:h,URLSearchParams:m,Text:g,TextDecoder:y,TextEncoder:f,document:b,RegExp:w,HTMLElement:v,customElements:A,Symbol:E,parseInt:j,addEventListener:L,removeEventListener:x,CSSStyleDeclaration:F,Date:S,Event:T,CustomEvent:z,ErrorEvent:R,JSON:P,indexedDB:C,IDBRequest:I,undefined:k,DOMParser:M,prompt:B,alert:U,fetch:N,XMLHttpRequest:$,location:O,matchMedia:_,styleMedia:W,Document:H,Node:J,NodeList:G,KeyboardEvent:q,StyleSheet:K,console:V,EventTarget:Z}=e,X=["success","error","progress"];class Q extends v{constructor(){super();const e=this;e.ElmName=se.toUp("TAG_"+e.tagName.replace(/-/g,"_")),e.getFunc("INIT")}getFunc(e,t){let r=e?"_"+e:"",s=ne.action[this.ElmName+r];s&&s.apply(this,t||[])}connectedCallback(...e){this.getFunc(null,e),ne.docload((()=>this.getFunc("READY",e)))}attributeChangedCallback(...e){this.getFunc("ATTR",e)}disconnectedCallback(...e){this.getFunc("REMOVE",e)}}class Y{constructor(e,t){t=t||{},r.assign(this,{name:e,config:t,tables:[],Store:{}}),ne.StoreList[e]=this}open(e){var t=this;return se.Async(((r,s)=>{let a=C.open(t.name,t.version);a.once("error",(async e=>{throw e})),a.once("upgradeneeded",e||(e=>{let r=e.target.result;se.toArr(t.config,(e=>{var[t,s]=e;if(!r.objectStoreNames.contains(t)){var a=r.createObjectStore(t);V.log(e),se.toArr(s,(e=>{e[1]&&e[1].options?a.createIndex(e[0],e[1].keyPath||e[0],e[1].options):a.createIndex(e[0],e[0],e[1]||{unique:!1})}))}}))})),a.once(X[0],(async s=>{let a=s.target.result;return t.tables=se.toArr(a.objectStoreNames),t.version=a.version+1,t.check(t.config,t.tables).length>0?(a.close(),r(t.open(e))):(t.Store={},r(a))}))}))}check(e,t){return e=se.toArr(e),t=se.toArr(t),e.filter((e=>!t.includes(e[0])))}table(e){var t=this;return t.Store[e]||(t.Store[e]=new ee(e,t)),t.Store[e]}async getTable(e,t){var r=this;r.config[e]||(r.config[e]=t||{}),r.db||(r.db=r.open());var s=await r.db;return r.check(r.config,r.tables).length>0&&(r.version+=1,s.close(),r.db=r.open(),s=await r.db),s}transaction(e,t,r){return r?r.transaction([e],t?k:"readwrite").objectStore(e):se.Async((async r=>r(this.transaction(e,t,await this.getTable(e)))))}async clear(){var e=this;return e.db&&(await e.db).close(),e.db=k,C.deleteDatabase(e.name)}async delete(e){var t=this;t.db||se.toArr(await C.databases(),(e=>{t.name===e.name&&(t.version=e.version+1)})),t.db=t.open((t=>{let r=t.target.result;se.str(e)&&(e=[e]),se.toArr(e,(e=>r.objectStoreNames.contains(e)&&r.deleteObjectStore(e)))}))}}class ee{constructor(e,t,s){r.assign(this,{table:e,IDB:t,opt:s,getDB:()=>t.getTable(e,s)})}async load(e,t){return this.success(e.get(t))}async save(e,t,r){return this.success(e.put(t,r))}success(e,t){return se.Async((r=>e.on(X[0],(s=>{var a=e.result;t?t(r,a):r(a)}))))}async transaction(e){var t=this;return t.IDB.transaction(t.table,e,await t.getDB())}get read(){return this.transaction(!0)}get write(){return this.transaction(!1)}getCursor(e,t){var r={};return this.success(e,((e,s)=>{if(s){if(se.func(t))return t(e,s);var{primaryKey:a,key:n,value:i}=s;i?se.str(t)?i&&i[t]&&(r[a]=i[t]):r[a]=i:r[a]=n,s.continue()}else e(r)}))}async get(e,t,r){var s=this,a=await s.read;if(se.str(e)){let m=await s.load(a,e);if(se.obj(m)&&m.contents){var{contents:n,type:o,tag:c,filesize:l,filetype:p,filename:u,version:d}=m;if(t&&d&&t!=d)return;if(o==v.name)n=ne.docElm(n),c&&(n=ne.$(c,n));else if(!se.str(n)&&l>ne.maxsize&&n.length>0&&n.length!=l){se.blob(n)&&(n.name&&(u=n.name),n.type&&(p=n.type));var h=e.split(ne.part)[0];n=await se.Async(se.toArr(l/ne.maxsize+1).map((async(t,r)=>{let i=h;return r>0&&(i+=ne.part+r),e==i?n:(await s.load(a,i)).contents}))),n=se.File(n,u||e,p),o!=i.name&&(n=await se.toU8(n))}if(r)return n;m.contents=n}return m}if(se.array(e))return se.toObj(se.Async(e.map((async e=>[e,await s.load(a,e)]))))}async put(e,t){var s=this,a=await s.write;if(t||se.toArr(a.indexNames,(r=>{!t&&e[r]&&(t=e[r])})),se.obj(e)&&e.contents){var{contents:n,filesize:i,filetype:o}=e;if(n&&(i||(i=n.size||n.length),o||(o=n.type||ae.getMime("*")),i&&i>ne.maxsize))return delete e.contents,se.Async(se.toArr(i/ne.maxsize+1).map((async(c,l)=>{let p=t;l>0&&(p+=ne.part+l);var u=l*ne.maxsize,d=await se.toU8(n.slice(u,i-u>=ne.maxsize?u+ne.maxsize:i));return s.save(a,r.assign({contents:d,filesize:i,filetype:o,timestamp:ne.date},e)),p})))}return s.save(a,e,t)}async putdata(e,t,s,a){let n=r.assign({contents:t,timestamp:ne.date},a);return s&&(n.version=s),this.put(n,e)}async getdata(e,t){return this.get(e,t,!0)}async delete(e){var t=this,r=await t.write;return se.str(e)?t.success(r.delete(e)):se.array(e)?se.Async(se.toArr(e).map((e=>t.success(r.delete(e),(t=>e))))):void 0}async remove(e){let t=this,r=await t.load(t.read,e);if(se.obj(r)){var{filesize:s}=r;if(s&&s>ne.maxsize)return t.delete(se.toArr(s/ne.maxsize+1).map(((t,r)=>{let s=e.split(ne.part)[0];return r>0&&(s+=ne.part+r),s})))}return t.delete(e)}async clear(){return this.success((await this.write).clear())}async count(e){return this.success((await this.read).count(e))}async all(e,t){return this.success((await this.read).getAll(e,t))}async keys(e,t){return this.success((await this.read).getAllKeys(e,t))}async key(e){return this.success((await this.read).getKey(e))}index(e){var t=this;return new class{get request(){return se.Async((async r=>r((await t.read).index(e))))}async cursor(e,r,s){return t.cursor(e,r,s,await this.request)}async keys(e,r,s){return t.keyCursor(e,r,s,await this.request)}get(e){return t.load(this.request,e)}}}async cursor(e,t,r,s){return s?se.await(s)&&(s=await s):s=await this.read,this.getCursor(s.openCursor(t,r),e)}async keyCursor(e,t,r,s){return s?se.await(s)&&(s=await s):s=await this.read,this.getCursor(s.openKeyCursor(t,r),e)}}class te extends Z{ispack=/(zip|rar|7z)$/;unpackText="unpack:";downText="down:";constructor(e){super();var t=this;se.str(e)?t.url=e:r.assign(t,e),e.libjs&&(t.store=ne.LibStore,t.type=se.L(n)),r.assign(t,{onprogress(e,r,s){t.progress&&t.progress(s+"("+(r?se.PER(e,r):e)+")",e,r)},onsuccess(e,r){t.toEvent(X[0],{result:e,headers:r})},onerror(e){t.onsuccess(),t.error&&t.error(e,t)},oncancel(e){e.body&&e.body.cancel()},getItem:async(e,r)=>t.DB&&t.DB.get(e,r),async setItem(e,r,s,a){t.DB&&(s&&(e.contents=s),a&&(e.type=a),t.DB.put(e,r))},urlname:ae.getname(t.url)||"index.html",DB:ne.getTable(t.store),result:new u((e=>{t.once(X[0],(function(r){var{result:s,headers:a}=r.detail;e(s),t.success&&t.success(s,a)}))}))}),t.onsend()}async onsend(){var e,t,a=this,{urlname:o,type:l,libjs:p,store:u,key:d,unpack:h,filename:m,onLine:g,option:y,version:f,ispack:b,onsuccess:w,oncancel:A,onerror:E}=a,j=e=>{w(e,t)},L=async()=>{if(x&&x.contents){var{filename:e,fileext:t,contents:r,type:s}=x;x="unpack"==s?await new re({contents:r,Name:e,ext:t,onprogress:(e,t,r)=>this.onprogress(e,t,this.unpackText+r),password:x.password||this.password}).result:r}return j(x)};d=d||o,m=m||o,p&&(b.test(d)&&(d=ne.LibPad+d.replace(b,"js"),h=!0),ne.LibStore);var x=await this.getItem(d,f);if(x&&(!g||!ne.onLine))return L();var F=await a.response();if(se.nil(F))return x?L():E({message:this.statusText});(t=ae.FilterHeader(se.toObj(F.headers)||{})).filename||(t.filename=m);var{filetype:S,filesize:T,password:z}=t;if(z&&(a.password=z),"head"==l)return A(F),j(t);if(x){if(!x.filesize||T==x.filesize)return A(F),L();x=k}return 200!=F.status?E({message:(x=S==ae.getMime(ne.ts[1])?await F.json():await F.text())||F.statusText,headers:t}):(T=(e=await a.steam(F,t)).size,l!=se.L(n)?(e=await se.toU8(e),this.Filter?e=await this.Filter(e,o,t):l&&(e=se.decode(e,this.charset)),l==ne.ts[1]?(e=se.Json(e),l=ne.ts[1]):l==ne.ts[2]?(l=v.name,e=ne.docElm(e)):l=se.u8buf(e)?c.name:s.name):l=i.name,y=r.assign(y,{timestamp:ne.date,filename:m,filesize:T,filetype:S,type:l}),f&&(y.version=f),(se.u8buf(e)||se.blob(e))&&h?this.onpack(e,y,d,t):e?(this.setItem(y,d,e),j(e)):void 0)}async onpack(e,t,s,a){var n,o=await ae.CheckExt(e);if(o&&this.ispack.test(o)){var l,p=new re({contents:e,Name:t.filename,ext:o,password:this.password,onprogress:(e,t,r)=>this.onprogress(e,t,this.unpackText+r)}),u=0;if(n=await p.result,se.obj(n)){if(await se.Async(se.toArr(n).map((async e=>{var[r,a]=e;if(this.libjs){r=ae.getname(r);var o=ae.getMime(r),p=ne.LibPad+r;a=this.reBuf(a,this.unbuf,r,o),await this.setItem({contents:a,filename:r,filesize:a.byteLength,filetype:o,type:se.blob(a)?i.name:se.blob(a)?c.name:this.unbuf,version:t.version},p),p==s&&(l=a)}else u+=a.byteLength,n[r]=this.reBuf(a,this.unbuf)}))),l)return e=null,this.onsuccess(l,a);if(this.libjs&&n)return this.onsuccess(n,a)}e&&u&&(t.fileext=o,u>ne.maxsize?(t.type="unpack",p.password&&(t.password=p.password)):(e=n,t.type=r.name))}if(await this.setItem(t,s,e),n)return this.onsuccess(n,a);this.onsuccess(e,a)}cancel(e){e.body&&e.body.cancel()}async steam(e,t){var{body:r}=e;if(!r||!r.getReader)return e.blob();var{filename:s,type:a,length:n}=t;let i=0,o=0,c=await r.getReader(),l=[];for(;;){const{done:e,value:t}=await c.read();if(e)break;o=t.length,i+=o;let r="";n&&i<=n?r=i:(r=`${(i/1024).toFixed(1)}KB`,n=0),this.onprogress(r,n,this.downText+s),l.push(t)}return se.File(l,s,a)}reBuf(e,t,r,s){return t==ne.ts[0]?e=se.decode(e,this.charset):t==ne.ts[1]?e=se.Json(se.decode(e,this.charset)):!t&&r&&(e=se.File([e],r,s)),e}response(){var{url:e,get:t,post:s,head:a,json:n,headers:i}=this;let o={headers:i||{}};return r.assign(o,a),n?(s=se.toJson(ARG.json),o.headers.Accept=ae.getMime(ne.ts[1])):s&&(s=se.toPost(ARG.post)),s&&(o.method="POST",o.body=s),N(se.toGet(e,t),o).catch((e=>{this.statusText=e}))}}class re extends Z{src7z="extract7z.zip";srcrar="libunrar.min.zip";constructor(e){super(),se.obj(e)||!se.buf(e)&&!se.blob(e)?r.assign(this,e):this.contents=e,this.on(X[2],(function(e){this.onprogress&&this.onprogress.apply(this,e.detail)})),this.result=new u((e=>{this.once(X[0],(function(t){var{detail:r}=t;e(r),this.success&&this.success(r)}))})),this.contents&&this.ondone()}async ondone(){var{ext:e,contents:t}=this;e||(e=await ae.CheckExt(t));var r=/(zip|rar|7z)$/.test(e)&&(/zip$/.test(e)&&await this.zip()||await this.rar(e))||await se.toU8(t);this.toEvent(X[0],r)}async extractor(e){return se.Async((async t=>{ae.getLibjs("extractor-new.min.zip").catch((e=>t())).then((r=>{if(!r)return t();var s,a,i=new Worker(r),o={},l=0;i.onmessage=e=>{var{file:r,data:p,size:u,end:d,total:h,error:m}=e.data;h?a=h:d?(se.Async(se.toArr(o).map((async e=>{var[t,r]=e;return[t,r.length?await se.toU8(new n(r)):new c]}))).then((e=>{e=e.length?se.toObj(e):k,t(e)})),i.terminate()):r&&!/\/$/.test(r)?(o[r]=[],s=r):p&&s?(l+=u,o[s].push(p)):m&&!o[s].length&&delete o[s],s&&this.toEvent(X[2],[l,a,s])},i.onerror=e=>{i.terminate(),t()},i.onmessageerror=i.onerror,i.postMessage({filename:this.Name||"test."+(e||"zip"),data:this.contents,DB_NAME:ne.DB_NAME,DB_TABLE:ne.LibStore,DB_FILE:ne.LibPad+"extractor-new.wasm"})}))}))}async rar(e){var{contents:t,password:r,onprogress:s,src7z:a,srcrar:n}=this,i=e&&/7z$/.test(e)?a:n;t=await se.toU8(t);let o=await ae.getLibjs(i,s);return se.Async((e=>{let s,a=new Worker(o),n=e=>a.terminate();a.onmessage=t=>{if(se.obj(t.data)){var{t:i,data:o,file:c,total:l,current:p,name:u}=t.data;if(1==i)e(s||k);else{if(2==i)return!s&&(s={}),o&&(s[c]=o);if(4==i)return l>0&&l>=p&&this.toEvent(X[2],[p,l,u||c]);if(-1===i){if(r=B("Enter password.",r||""))return a.postMessage({password:r});e(k)}}n()}},a.onerror=t=>{e(k),n()},a.onmessageerror=a.onerror,a.postMessage({contents:t,password:r})}))}async getEntries(e,t,r){if(se.none(t)){var s,a=e.filter(((e,t)=>{if(se.none(s)&&e.encrypted)return s=t,!0}))[0];if(a)return(a=await this.getEncrypted(a,this.password))?(e.splice(s,1),await this.getEntries(e,a[0],a[1])):k}return se.toObj((r?[r]:[]).concat(await se.Async(e.filter((e=>!e.directory)).map((async e=>[e.filename,await this.getData(e,t)])))))}async getData(e,t){return e.getData(new zip.Uint8ArrayWriter,{password:t,onprogress:(t,r)=>this.toEvent(X[2],[t,r,e.filename])})}async getEncrypted(e,t){var r=await se.Async((r=>{this.getData(e,t).catch((r=>(t=B("Enter password.",t))?this.getEncrypted(e,t):k)).then((e=>r(e)))}));return this.password=t,se.u8buf(r)||se.blob(r)?[t,[e.filename,r]]:r}async zip(){var{contents:t}=this;typeof e.zip===se.TP()&&await ne.loadLibjs(ne.zipsrc,this.onprogress),se.blob(t)||(t=new n([t.buffer||t],{type:ae.getMime("*")}));var r=new zip.ZipReader(new zip.BlobReader(t)),s=await r.getEntries();if(!se.empty(s))return await this.getEntries(s)}}const se={IF:(e,t)=>e instanceof t,IC:(e,t)=>se.CS(e)===t,TP:e=>typeof e,N:e=>e.name||se.CS(e)&&se.CS(e).name||se.TP(e),NC:e=>se.toLow(se.N(e)),R:(e,...t)=>Reflect.construct(e,t),L:e=>(se.ST(e)||se.N(e)||se.toStr(e)).replace(/^(\w)/,(e=>se.toLow(e))),C:e=>se.CS(e),CS:e=>!se.nil(e)&&e.constructor,DP:(e,t)=>Reflect.deleteProperty(e,t),FE:(e,t)=>t&&e.forEach&&e.forEach(t)||e,FM:(e,t)=>t&&e.map&&e.map(t)||e,NN:e=>se.toLow(e.nodeName),ST:e=>se.toLow(e[E.toStringTag]||""),dE:e=>(e||b).documentElement,dElm:(e,t)=>se.dE((new M).parseFromString(e,t)),elm:e=>se.IF(e,v),node:e=>se.IF(e,J),nodelist:e=>se.IF(e,G),isDoc:e=>se.IF(e,H),await:e=>se.IF(e,u),blob:e=>se.IF(e,n),file:e=>se.IF(e,i),evt:e=>se.IF(e,T),keyevt:e=>se.IF(e,q),func:e=>se.IF(e,l)&&!se.isClass(e),isClass:e=>/^class\s/.test(se.toStr(e.constructor)),array:e=>t.isArray(e),obj:e=>se.IC(e,r),buf:e=>se.IC(e&&e.buffer||e,o),u8obj:e=>se.IC(e,c),u8buf:e=>se.u8obj(e),str:e=>se.IC(e,s),toURL:e=>h.createObjectURL(e),reURL:e=>h.revokeObjectURL(e),bool:e=>se.IC(e,p),num:e=>se.IC(e,a),null:e=>null===e,none:e=>se.TP(e)==se.TP(),nil:e=>se.null(e)||se.none(e),Arr:e=>new t(e),ArrFrom:e=>t.from(e),Proto:e=>!se.nil(e)&&e.prototype,hasOwnProp:(e,t)=>se.hasProp(se.Proto(e),t),hasProp:(e,t)=>e.hasOwnProperty(t),toBuf:e=>e.arrayBuffer(),Blob2U8:async e=>se.toU8(await se.toBuf(e)),toU8:e=>se.u8buf(e)?e:se.blob(e)?se.Blob2U8(e):new c(e.buffer||e),U8:e=>se.toU8(e),toStr:(e,t)=>e.toString(t),toUp:e=>e&&e.toUpperCase(),toLow:e=>e&&e.toLowerCase(),decode:(e,t)=>new y(t).decode(e),encode:e=>(new f).encode(e),isForm:e=>se.IF(e,d),setForm:e=>new d(e),setParam:e=>new m(e),Int:e=>se.IntVal(e),IntVal:(e,t)=>j(e,t),PER:(e,...t)=>se.Int(100*e/t[0]).toFixed(0)+(t[1]?"":"%"),Async:(e,t)=>se.array(e)?t?u.allSettled(e):u.all(e):se.func(e)?new u(e):u.resolve(),setStyle:(e,t)=>(se.toArr(t,(t=>(e.style||e).setProperty(t[0],t[1]))),e),getStyle:e=>se.EachItem(e.style||e),getAttr:(e,t)=>e.getAttribute(t),setAttr:(e,t,r)=>r?e.setAttribute(t,r):se.getAttr(e,t),reAttr:(e,t,r)=>se.nil(r)?e.removeAttribute(t):se.setAttr(e,t,r),getProp:(e,t)=>e.getPropertyValue(t),putProp:(e,t,r)=>r?e.setProperty(t,r):se.getProp(e,t),setProp:(e,t,r)=>r?se.putProp(e,t,r):e.removeProperty(t),Attr:(e,...t)=>se.obj(t[0])?se.toArr(t[0],(t=>se.Attr(e,t[0],t[1]))):t[0]?se.setAttr(e,...t):se.toObj(e.attributes),toApply:(e,...t)=>e&&Reflect.apply(e,t.shift(),t),EachItem(e,t){var s=[],a={};if(e.forEach)e.forEach(((e,r)=>{!0===t?se.num(r)?s.push(e):s.push([r,e]):!1===t&&se.array(e)&&2==e.length?a[e[0]]=e[1]:a[r]=e}));else if(e.item)for(let t=0;t<e.length;t++){var n,i=e.item(t);if(se.str(i))(n=se.toApply(e.getPropertyValue,e,i))?a[n]=i:s.push(i);else i&&(i.name?a[i.name]=i.value:s.push(i))}else if(se.func(e.entries))for(var o=e.entries();;){var c=o.next();if(c.done)break;if(se.array(c.value)){var[n,i]=c.value;t?se.num(n)?s.push(i):s.push(c.value):a[n]=i}else s.push(c.value)}return!0===t&&(a=r.entries(a)),s.length?!1===t?r.fromEntries(s.map(((e,t)=>se.array(e)&&2==e.length?e:[t,e]))):s:a},getEntries:e=>se.array(e)?e:se.obj(e)?r.entries(e):se.num(e)||e.byteLength?se.ArrFrom(se.toU8(e.buffer||e)):se.EachItem(e,!0),define:(e,t,s,a,n)=>r.defineProperty(e,t,!a||se.obj(s)&&s.value?s:{get:se.func(s)?s:()=>s,configurable:1==n}),defines:(e,t,s,a)=>s?se.toArr(t,(t=>se.define(e,t[0],t[1],1,a))):r.defineProperties(e,t),assign:(...e)=>(se.array(e[0])&&(e=[].concat(...e)),r.assign({},...e)),empty:e=>!e||0==e||(se.str(e)?0==e.trim().length:0==se.toArr(e).length),Json:e=>(se.u8buf(e)&&(e=se.decode(e)),se.str(e)?new l("return "+e)():e),toJson:e=>P.stringify(se.Json(e)),progress(e,...t){e&&(t[0]+=" "+se.PER(t[1],t[2]),e&&e.apply(t[3],t))},File:(e,t,r)=>new i(e,t,{type:r,lastModified:S.now()}),toPost(e){let t=se.isForm(e)?e:se.setForm(se.elm(e)?e:se.str(e)?ne.$(e):k);return se.obj(e)&&se.toArr(e,(e=>t.append(e[0],e[1]))),t},toGet(e,...t){let r=e.split("?"),s=r[1]&&r[1].split("#")[0]||"",a=se.toArr(se.toObj(se.setParam(s+"&"+t.map((e=>se.obj(e)?se.setParam(e):e)).join("&")))).map((e=>e[0]+"="+e[1])).join("&").replace(/=&/g,"&");return r[0]+(a?"?"+a:"")},toObj:e=>se.obj(e)?e:se.EachItem(e,!1),toArr(e,t){if(!e)return[];let r=se.getEntries(e);return se.func(t)?se.FE(r,t):r}},ae={Libjs:{},ext16:{"7z":/^377ABCAF271C/,rar:/^52617221/,zip:/^504B0304/,png:/^89504E470D0A1A0A/,gif:/^47494638(3761|3961)/,jpg:/^FFD8FFE000104A464946/,webp:/^52494646\w{8}57454250/,pdf:/^255044462D312E/,bmp:/^424D\w{4}0{8}/},exttype:{text:["css","scss","sass","html","htm","xml","vml",["style","css"],["html","html"],["php","html"],["txt","plain"]],image:["jpg","jpeg","png","gif","webp","avif","apng","heic",["svg","svg/xml"]],font:["woff","woff2","ttf","otf"],application:["pdf","json",["js","javascript"],["*","octet-stream"],["zip","x-zip-compressed"],["rar","x-rar-compressed"],["7z","x-7z-compressed"]]},CheckExt(e){let t=e.slice(0,16),r=se.blob(t)?se.toU8(t):se.str(t)?se.encode(t):t;return se.await(r)?se.Async((async e=>{e(ae.mimeHead(await r))})):ae.mimeHead(r)},async getLibjs(e,t,r,s,a){let n=ae.getname(e),i=n.replace(/\.zip$/,".js");if(ae.Libjs[n])return ae.Libjs[n];if(ae.Libjs[i])return ae.Libjs[i];r=r||ne.version;let o=await ne.getTable(ne.LibStore).getdata(ne.LibPad+i,r);return o||(o=await ne.FetchItem({url:ne.JSpath+"lib/"+e+"?"+ne.time,libjs:!0,version:r,progress:t,Filter:s,unbuf:!!a&&ne.ts[0]})),/json$/.test(i)?ae.Libjs[i]=o:o&&(se.obj(o)?se.toArr(o,(e=>ae.Libjs[e[0]]=e[1]&&ae.URL(e[1],e[0]))):ae.Libjs[i]=ae.URL(o,i)),o=null,ae.Libjs[i]},URL:(e,t)=>se.str(e)&&e.length<255&&/^(blob|http|\/{1,2}(?!\*)|\.\/|.+\/)[^\n]*?$/i.test(e)?e:se.toURL(se.blob(e)?e:new n([e],{type:ae.getMime(t||se.u8buf(e)&&ae.CheckExt(e)||"js")})),reURL:e=>se.reURL(e),getname(e){let t=(e||"").split("/").pop().split("?")[0].split("&")[0].split("#")[0];return!e||t&&/\.\w+$/.test(t)?t||"":(e=e.match(/(\?|\&)?([^\&]+\.[a-z0-9A-Z]+)\&?/))&&e[2]||""},getExt:e=>se.toLow(ae.getname(e).split(".").pop()),getKeyName:e=>ae.getname(e).replace(/\.\w+$/,""),getMime(e,t){let r;return e=e&&se.toLow(e)||"",/^\w+\/[\w\;]+$/.test(e)?e:(e=ae.getExt(e)||e.split(".").pop(),ae.extlist||(ae.extlist=se.assign(se.toArr(ae.exttype).map((e=>se.array(e[1])?se.toObj(e[1].map((t=>{if(se.array(t))return[t[0],e[0]+"/"+t[1]];let r=e[0];return/\//.test(r)||(delete ae.exttype[r],r+="/"+t,ae.exttype[r]=!0),[t,r]}))):se.obj(e[1])?se.toObj(se.toArr(e[1]).map((t=>[t[0],e[0]+"/"+t[1]]))):void 0)))),r=ae.extlist[e]||ae.extlist["*"],t&&/(text|javascript|xml|json)/.test(r)?r+";chartset=utf8":r)},getType:e=>(e=ae.getMime(e)).split("/").pop(),FilterHeader:e=>(se.toArr(e,(t=>{if(/content-/.test(t[0])){let r=t[0].replace("content-",""),s=decodeURI(t[1]);switch(isFinite(s)&&(s=se.IntVal(s)),r){case"disposition":let t=s.match(/^attachment;\s*filename=[\"\']+?(.+)[\"\']+?$/i);t&&t[1]&&(e.filename=decodeURI(t[1]));break;case"length":e.filesize=s;case"password":e[r]=s;break;case"type":s=se.toLow(s);let a=s.split(";");e.filetype=s,e[r]=a[0].trim(),a[1]&&(e.charset=se.toLow(a[1].split("=").pop().trim()));break}}})),e),ajaxHeader:e=>ae.FilterHeader(se.toObj((e.getAllResponseHeaders()||"").trim().split(/[\r\n]+/).map((e=>{let t=e.split(": ");return[t.shift(),t.join(": ")]})).concat([["status",e.status],["statusText",e.statusText],["url",e.responseURL]]))),HtmltoStr(e){se.elm(e)&&!e.contents&&(e={contents:e});let t=e&&e.contents;return se.elm(t)&&(e.contents=t.outerHTML,e.tag=se.NN(b.body),e.type=v.name),e},mimeHead(e){let t=se.toUp(se.toArr(e).map((e=>se.toStr(e,16))).join("")),r=se.toArr(ae.ext16).filter((e=>e[1].test(t)))[0];return r&&r[0]?r[0]:""}},ne=new class extends Z{version=1;DB_NAME="XIUNOBBS";DB_STORE_MAP={libjs:{},myfile:{timestamp:!1}};LibStore="libjs";LibPad="script-";maxsize=104857600;part="-part-";lang={};action={};StoreList={};isLocal=/^(127|localhost|172)/.test(O.host);zipsrc="zip.min.js";get I(){return se}get F(){return ae}get date(){return new S}get time(){return S.now}CLASS=[Q,te,Y,ee,re];getStore(e,t){return e&&e!=ne.DB_NAME||(e=ne.DB_NAME,t=t||ne.DB_STORE_MAP),ne.StoreList[e]||new Y(e,t)}getTable(e,t,r){return e?se.IF(e,ee)?e:se.str(e)?ne.getStore(t,r).table(e):void 0:k}async FetchItem(e){return new te(e).result}ajax(e){return e=r.assign({url:O.href},e||{}),se.Async((t=>{const s=new $(e.paramsDictionary),a=ne.ts;let i,o,c=(...r)=>{e.success&&e.success.apply(s,r),t(r[0])},l="head";s.on("readystatechange",(r=>{let p=s.readyState;if(2===p)i=ae.ajaxHeader(s),o=i.type,e.type?e.type==l&&s.abort():o==ae.getMime(a[1])?s.responseType=a[1]:o==ae.getMime("xml")?s.responseType="xml":!i.filename&&/(text|html|javascript|css)/.test(o)||(s.responseType=se.L(n));else if(4===p){if(e.type==l)return c(i);let r=s.response;return se.blob(r)&&(r=se.File([r],i.filename||ae.getname(e.url),o)),200==s.status?c(r,i):((...r)=>{e.error&&e.error.apply(s,r),t(null)})(s.statusText||"net::ERR_FAILED",i,r)}})),se.func(e[X[2]])&&s.on(X[2],(t=>se.progress(e[X[2]],"",t.loaded,t.total,t))),se.func(e.postProgress)&&s.upload.on(X[2],(t=>se.progress(e.postProgress,"",t.loaded,t.total,t))),e.upload&&se.toArr(e.upload,(e=>s.upload.on(e[0],e[1])));let p,u=e.headers||{};e.overType&&s.overrideMimeType(e.overType),e.json?(p=se.toJson(e.json),r.assign(u,{Accept:[ae.getMime(a[1]),ae.getMime(a[0]),"*/*"].join()})):e.post&&(p=se.toPost(e.post)),e.type&&e.type!=l&&(s.responseType=e.type),s.open(p?"POST":"GET",se.toGet(e.url,{inajax:ne.time},e.get)),se.toArr(u,(e=>s.setRequestHeader(e[0],e[1]))),s.send(p)}))}async FetchCache(e,t,r,s){t=t||se.L(n);let a=await caches.open(s||ne.DB_NAME),i=await a.match(e);if((!i||r&&ne.date-S.parse(i.headers.get("date"))>r)&&(i=await N(e),i&&a.put(i.url,i.clone())),i)return i[t]()}addJS(e,t,s,a){return se.Async((a=>{s=s||se.buf(e)&&(e.type&&/css$/.test(e.type)||e.name&&/css$/.test(e.name));var n=ae.URL(e),i=ne.$ce(s?"link":"script");r.assign(i,{type:ae.getMime(s?"css":"js"),href:n,src:n,rel:K.name,crossorigin:"anonymous",onload(r){e!=n&&ae.reURL(n),e=null,a(t&&t(r))},onerror(e){this.onload(e)}}),ne.$append(s?b.head:b.body,i)}))}async loadLibjs(e,t,r,s,a){return await ne.addJS(await ae.getLibjs(e,t,r,s,a),null,"css"==ae.getExt(e))}async unFile(e,t,s){return new re(r.assign(s||{},{contents:e,onprogress:t})).result}customElement(e){!A.get(e)&&A.define(e,Q)}Err(e){return new Error(e)}async download(e,t,r){let s;!t&&e&&(t=e,e=null),/^(http|blob:|data:)/.test(t)?(s=t,!e&&/^(http|blob:)/.test(t)&&(e=ae.getname(t))):t&&(s=ae.URL(t,r),e||(e=t.name||ne.ts[3]+"."+(await ae.CheckExt(t)||ne.ts[3])));let a=ne.$ce("a");a.href=s,a.download=e||"test.txt",a.click(),a.remove()}triger(e,t,r){return e=ne.$(e),r||(r={detail:e}),se.evt(t)?ne.dispatch(e,t):ne.dispatch(e,new z(t,r)),e}dispatch(e,t){return e.dispatchEvent(t),e}setClass(e){(e=e||new class extends Z{}).action=e.action||{};var{RF:t,CF:r,BF:s}=this;return se.defines(e,{I:se,T:ne,F:ae,RF:{value:t},CF:{value:r},BF:{value:s}},!0),e}onEvent(e,t,r,s,a){return e=ne.$(e),t.split(/\s+/).forEach((t=>e.on(t,r,!1===s?{passive:!1}:s,a))),e}unEvent(e,t,r,s,a){return e=ne.$(e),t.split(/\s+/).forEach((t=>e.un(t,r,!1===s?{passive:!1}:s,a))),e}onceEvent(e,t,r,s){return e.once(t,r,{passive:!1,once:!0},s)}docload(e){if(b.readyState!=ne.readyState)return e&&e.call(ne);b.once("DOMContentLoaded",e)}$(e,t){return e?se.str(e)?(t||b).querySelector(e):se.func(e)?ne.docload(e):e:k}$$(e,t){return(t||b).querySelectorAll(e)||[]}$ce(e){return b.createElement(e)}$ct(e,t,r){let s=ne.$ce(e);return t&&(s.innerHTML=se.str(t)?t:t()),se.Attr(s,r?se.str(r)?{class:r}:r:k),s}$append(e,t){return se.str(t)&&(t=ne.$ce(t)),e.appendChild(t),t}$add(e,t){return e.classList.add(t),e}async getItemAppend(e,t,r){let s=ne.part,a=e.split(s)[0],n=se.toArr(t.filesize/ne.maxsize+1).map((async(n,i)=>{let o=a;return i>0&&(o+=s+i),e==o?t.contents:(await D.GET_ITEM(o,r)).contents})),i=se.File(await se.Async(n),a,t.filetype);return t.contents=null,i}docElm(e,t){return se.dElm(e,t||b.contentType)}RF(e,t){const r=this.action[e];return se.func(r)?r.apply(this,t||[]):r}CF(e,...t){return this.RF(e,t)}BF(e,...t){const r=this.action,s=t.shift();return se.func(r[e])?t.length?this.RF(e):r[e].apply(s,t):r[e]}getLang(e,t){return ne.GL(e,t)}GL(e,t){return se.none(ne.lang[e])||(e=ne.lang[e]),t?ne.toReplace(e,t):e}toReplace(e,t){return se.str(t)?e=e.replace(/{value}/,t):se.obj(t)&&se.toArr(t,(t=>e.replace(new w(t[0],"g"),t[1]))),e}MediaQuery(e,t){if(_){let r=_(e);r.on("change",(e=>t(e.matches,e))),t(r.matches)}}MediaMath(e){return W.matchMedium(e)}async toZip(e,t,r){typeof zip===se.TP()&&await ne.loadLibjs(ne.zipsrc,t);const s=new zip.BlobWriter,a=new zip.ZipWriter(s,{password:r});if(!e)return a;if(se.none(e.length)){if(!se.obj(e))return a;se.toArr(e).map((e=>a.add(e[0],new zip.Uint8ArrayReader(e[1]),{onprogress:(r,s)=>se.progress(t,e[0],r,s)})))}else se.toArr(e).map((e=>a.add(e.name,new zip.BlobReader(e),{onprogress:(r,s)=>se.progress(t,e.name,r,s)})));return await a.close({onprogress:(e,r)=>se.progress(t,"enZip",e,r)}),await s.getData()}PostMessage(e){var t=this.sw;return t&&t.postMessage(e)}async openServiceWorker(e){var{serviceWorker:t}=navigator;t.register(e).then((e=>{var t;e.installing?(t=e.installing,this._PWAReady(!0)):e.active&&(t=e.active),t.on("statechange",(e=>{this.sendClient(e.target.active),ne.CF("pwa_statechange",e)})),b.on("visibilitychange",(function(){"visible"===b.visibilityState&&ne.sendClient(t)})),this.sendClient(t),ne.sw=t,e.on("updatefound",(e=>{this.sendClient(e.target.active),ne.CF("pwa_updatefound",e)}))}))}clearWorker(e){navigator.serviceWorker.getRegistrations().then((t=>t.forEach((t=>{t.active&&(e&&t.active.scriptURL.includes(e)?t.unregister():e||t.unregister())}))))}sendClient(e){e&&(e.postMessage({action:"CLIENT"}),e!=this.sw&&(this.sw=e))}setWorker(e){return e.on(X[1],(function(e){ne.clearWorker(),ne.CF("pwa_error",e)})),e.on("message",(async function(e){let t=e.data;if(ne.isLocal&&V.log(t),se.obj(t)){let{action:e,from:r}=t;if(e)if(se.str(e)){if("GETDBNAME"==e)return ne.docload((()=>{ne.PostMessage({action:"WOKERDBNAME",result:ne.DB_NAME})}));let r=await ne.CF(e,t);t.id?(t.result=r,ne.PostMessage(t)):ne.PostMessage(r)}else se.array(e)&&se.FM(e,(e=>[e,ne[e]||win[e]]));else r&&ne.CF(r,t)}})),!0}constructor(){super();var e=this;r.assign(Z.prototype,{on(e,t,r){return this.addEventListener(e,t,r)},un(e,t,r){return this.removeEventListener(e,t,r)},once(e,t,s){return this.addEventListener(e,t,r.assign({passive:!1,once:!0},!0===s?{passive:!0}:s||{}))},toEvent(e,t){this.dispatchEvent(new z(e,{detail:t}))}});var{language:t,serviceWorker:a,onLine:n}=navigator,{contentType:i,readyState:o,ontouchend:c,currentScript:l,characterSet:p}=b,d=l&&l.src.split("?"),h=d&&d[0].split("/").slice(0,-1).join("/")+"/",m=se.toLow(t).split("-");h&&(h=h.replace("static/","")),"zh"==m[0]&&("cn"==m[1]?m[1]="hans":"hk"!=m[1]&&(m[1]="hant")),r.assign(e,{JSpath:h,ROOT:h&&h.replace("assets/js/","")||O.pathname,langName:m[0],i18nName:m.join("-"),charset:se.toLow(p),language:t,onLine:n,readyState:o,isTouch:se.hasOwnProp(v,"ontouchstart"),ts:[se.L(g),se.L(P),ae.getType(i),i,se.L(s)]}),a&&(e.setWorker(a),e.sw=a.controller,e.PWAReady=new u((t=>{e.sw?t(!0):e._PWAReady=t})))}};e.onerror=(e,t,r,s,a)=>U(e+r+t),e.T=ne,se.defines(e,{Nenge:()=>ne},1)}));