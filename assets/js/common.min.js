!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).T={})}(this,(function(e){"use strict";const t=e,r="undefined"!=typeof globalThis?globalThis:this||self,{Array:s,Object:a,String:n,Number:i,Blob:o,File:c,ArrayBuffer:l,Uint8Array:p,Function:u,Boolean:d,Promise:g,FormData:m,URL:y,URLSearchParams:h,Text:f,TextDecoder:b,TextEncoder:w,document:v,RegExp:A,HTMLElement:E,customElements:x,Symbol:j,parseInt:L,addEventListener:F,removeEventListener:S,CSSStyleDeclaration:C,Date:T,Event:z,CustomEvent:R,ErrorEvent:I,JSON:P,indexedDB:M,IDBRequest:k,undefined:N,DOMParser:B,prompt:$,alert:U,fetch:O,XMLHttpRequest:_,location:H,matchMedia:J,styleMedia:W,Document:Z,Node:q,NodeList:G,KeyboardEvent:K,StyleSheet:V,console:X}=r;var Q={version:1,DB_NAME:"XIUNOBBS",DB_STORE_MAP:{libjs:{},myfile:{timestamp:!1}},LibStore:"libjs",LibPad:"script-",maxsize:104857600,part:"-part-",lang:{},action:{},StoreList:{},isLocal:/^(127|localhost|172)/.test(H.host),zipsrc:"zip.min.js",un7zsrc:"extract7z.zip",unrarsrc:"libunrar.min.zip",serviceActive:!1,mime:v.contentType,readyState:v.readyState,onLine:navigator.onLine,getStore:(e,r)=>(e||(e=t.DB_NAME,r=r||t.DB_STORE_MAP),t.StoreList[e]||new te(e,r)),getTable:(e,r,s)=>e?t.getStore(r,s).table(e):N,FetchItem:async e=>ne.Async((async t=>{var r=new se(e);e.success?t():r.done(t)})),ajax:e=>(e=ne.assign({url:H.href},e||{}),ne.Async((r=>{const s=new _(e.paramsDictionary),a=t.ts;let n,i,c=["progress","readystatechange","error"],l=(...t)=>{e.success&&e.success.apply(s,t),r(t[0])},p=ne.NN(v.head);t.on(s,c[1],(t=>{let c=s.readyState;if(2===c)n=ie.ajaxHeader(s),i=n.type,e.type?e.type==p&&s.abort():i==ie.getMime(a[1])?s.responseType=a[1]:i==ie.getMime("xml")?s.responseType="xml":!n.filename&&/(text|html|javascript|css)/.test(i)||(s.responseType=ne.L(o));else if(4===c){if(e.type==p)return l(n);let t=s.response;return ne.blob(t)&&(t=ne.File([t],n.filename||ie.getname(e.url),i,n["last-modified"])),200==s.status?l(t,n):((...t)=>{e.error&&e.error.apply(s,t),r(null)})(s.statusText||"net::ERR_FAILED",n,t)}})),ne.func(e[c[0]])&&t.on(s,c[0],(t=>ne.progress(e[c[0]],"",t.loaded,t.total,t))),ne.func(e.postProgress)&&t.on(s.upload,c[0],(t=>ne.progress(e.postProgress,"",t.loaded,t.total,t))),e.upload&&ne.toArr(e.upload,(e=>t.on(s.upload,e[0],e[1])));let u,d=e.headers||{};e.overType&&s.overrideMimeType(e.overType),e.json?(u=ne.toJson(e.json),ne.assign(d,{Accept:[ie.getMime(a[1]),ie.getMime(a[0]),"*/*"].join()})):e.post&&(u=ne.post(e.post)),e.type&&e.type!=p&&(s.responseType=e.type),s.open(u?"POST":"GET",ne.get(e.url,{inajax:t.time},e.get)),ne.toArr(d,(e=>s.setRequestHeader(e[0],e[1]))),s.send(u)}))),async FetchCache(e,r,s,a){r=r||ne.L(o);let n=await caches.open(a||t.DB_NAME),i=await n.match(e);if((!i||s&&t.date-T.parse(i.headers.get("date"))>s)&&(i=await O(e),i&&n.put(i.url,i.clone())),i)return i[r]()},addJS(e,r,s,n){ne.blob(e)&&(n=ie.getKeyName(e.name),/css/i.test(e.type)&&(s=!0));var i=ne.LC(v.scripts[0].nodeName);if(n&&(n+=i+n),n&&t.$("#"+n))return;let o=t.$ce(s?"link":i),c=r=>{var c=s?"css":"js";e=ie.URL(e,c),a.assign(o,{type:ie.getMime(c),href:e,src:e,rel:ne.NC(V),id:n||i+t.time,crossorigin:"anonymous",onload(t){r&&r(t),!s&&/^blob:/.test(e)&&ie.reURL(e),e=null}}),t.$append(s?v.head:v.body,o)};return r?(c(r),o):ne.Async(c)},async loadScript(e,r,s){(r=r||{}).url=ie.getpath(e),s?r.type=t.ts[0]:(r.store||(r.store=t.LibStore),r.key||(r.key=t.LibPad)),r.version=r.version||t.version;let a=await t.FetchItem(r);return s?a:await t.addJS(a)},addScript:async(e,r)=>await t.addJS(await t.loadScript(e,r,!0),null,"css"==ie.getExt(e)),loadLibjs:async(e,r,s,a,n)=>await t.addJS(await ie.getLibjs(e,r,s,a,n),null,"css"==ie.getExt(e)),unFile:async(e,t,r)=>ne.Async((s=>{new ae(a.assign(r||{},{contents:e,onprogress:t})).done(s)})),customElement(e){!x.get(e)&&x.define(e,ee)},Err:e=>new Error(e),async download(e,r,s){let a;!r&&e&&(r=e,e=null),/^(http|blob:|data:)/.test(r)?(a=r,!e&&/^(http|blob:)/.test(r)&&(e=ie.getname(r))):r&&(a=ie.URL(r,s),e||(e=r.name||t.ts[3]+"."+(await ie.CheckExt(r)||t.ts[3])));let n=t.$ce("a");n.href=a,n.download=e||"test.txt",n.click(),n.remove()},triger:(e,r,s)=>(e=t.$(e),s||(s={detail:e}),ne.evt(r)?t.dispatch(e,r):t.dispatch(e,new R(r,s)),e),dispatch:(e,t)=>(e.dispatchEvent(t),e),Set:e=>(e.action||(e.action={}),ne.defines(e,{I:{get:()=>ne},T:{get:()=>t},RF:{get:()=>t.RF},CF:{get:()=>t.CF},BF:{get:()=>t.BF}}),ne),on:(e,r,s,a,n)=>(e=t.$(e),r.split(/\s+/).forEach((t=>ne.on(e,t,s,!1===a?{passive:!1}:a,n))),e),un:(e,r,s,a,n)=>(e=t.$(e),r.split(/\s+/).forEach((t=>ne.un(e,t,s,!1===a?{passive:!1}:a,n))),e),once:(e,r,s,a)=>t.on(e,r,s,{passive:!1,once:!0},a),docload(e){if(v.readyState!=t.readyState)return e&&e.call(t);t.once(v,"DOMContentLoaded",e)},$:(e,r)=>e?ne.str(e)?ne.$(e,r):ne.func(e)?t.docload(e):e:N,$$:(e,t)=>ne.$$(e,t),$ce:e=>ne.$c(e),$ct(e,r,s){let a=t.$ce(e);return r&&(a.innerHTML=ne.str(r)?r:r()),ne.Attr(a,s?ne.str(s)?{class:s}:s:N),a},$append:(e,r)=>(ne.str(r)&&(r=t.$ce(r)),e.appendChild(r),r),$add:(e,t)=>(e.classList.add(t),e),async getItemAppend(e,r,s){let a=t.part,n=e.split(a)[0],i=ne.toArr(r.filesize/t.maxsize+1).map((async(t,i)=>{let o=n;return i>0&&(o+=a+i),e==o?r.contents:(await D.GET_ITEM(o,s)).contents})),o=ne.File(await ne.Async(i),n,r.filetype);return r.contents=null,o},docElm:(e,t)=>ne.dElm(e,t||v.contentType),RF(e,t){const r=this.action;if(r[e])return ne.func(r[e])?ne.Apply(r[e],t||[],this):r[e]},CF(e,...t){return this.RF(e,t)},BF(e,...t){const r=this,s=r.action;return ne.func(s[e])?t.length?r.RF(e,t):s[e].bind(r):s[e]},getLang:(e,r)=>t.GL(e,r),GL:(e,r)=>(ne.none(t.lang[e])||(e=t.lang[e]),ne.obj(r)?ne.RegRe(e,r):e),MediaQuery(e,r){if(J){let s=J(e);t.on(s,"change",(e=>r(e.matches,e))),r(s.matches)}},MediaMath:e=>W.matchMedium(e),async toZip(e,r,s){await t.loadZip(((e,s,a)=>ne.progress(r,t.zipsrc,s,a)));const a=new zip.BlobWriter,n=new zip.ZipWriter(a,{password:s});if(!e)return n;if(ne.none(e.length)){if(!ne.obj(e))return n;ne.toArr(e).map((e=>n.add(e[0],new zip.Uint8ArrayReader(e[1]),{onprogress:(t,s)=>ne.progress(r,e[0],t,s)})))}else ne.toArr(e).map((e=>n.add(e.name,new zip.BlobReader(e),{onprogress:(t,s)=>ne.progress(r,e.name,t,s)})));return await n.close({onprogress:(e,t)=>ne.progress(r,"enZip",e,t)}),await a.getData()},async loadZip(e){typeof zip===ne.TP()&&await t.loadLibjs(t.zipsrc,e)},async unZip(e,r){let s=(r=r||{}).progress;await t.loadZip(s);var a=new zip.ZipReader(ne.R(ne.u8buf(e)?zip.Uint8ArrayReader:zip.BlobReader,e)),n={},i=r.password,o=async e=>{n[e.filename]=await e.getData(new zip.Uint8ArrayWriter,{onprogress:(t,r)=>ne.progress(s,e.filename,t,r),password:i})},c=await a.getEntries(),l=0;if(c)for(;c[l];){let e=c[l];if(l++,!e.directory)if(e.encrypted&&!i){if(null===i)continue;await ne.AsyncTry((()=>o(e)),(e=>{if(null==(i=$(t.getLang(e),i)))return!0}))}else await o(e)}return n},setServiceWorker(){var{serviceWorker:e}=navigator;if(e.controller){t.sw_install=!0,ne.defines(t,{sw:{get:()=>e.controller},PostMessage:{value:e=>t.sw.postMessage(e)}}),t.on(t.sw,"statechange",(e=>{X.log(e)})),t.on(t.sw,"error",(e=>{X.log(e)}));var s="GETDBNAME";t.PostMessage({action:s,result:t.DB_NAME}),t.on(navigator.serviceWorker,"message",(async e=>{let a=e.data;if(ne.obj(a)){"127.0.0.1"==H.host&&X.log(a);let e=a.action;if(e)if(ne.str(e)){if("GETDBNAME"==e)return t.PostMessage({set:s,result:t.DB_NAME});let r=await t.CF(e,a);a.id?(a.result=r,t.postMessage(a)):t.postMessage(r)}else ne.array(e)&&ne.FM(e,(e=>[e,t[e]||r[e]]))}}))}}};const Y=["success"];class ee extends E{constructor(){super();const e=this;e.ElmName=ne.UC("TAG_"+e.tagName.replace(/-/g,"_")),e.getFunc("INIT")}getFunc(e,r){let s=e?"_"+e:"",a=t.action[this.ElmName+s];a&&a.apply(this,r||[])}connectedCallback(...e){this.getFunc(null,e),t.docload((()=>this.getFunc("READY",e)))}attributeChangedCallback(...e){this.getFunc("ATTR",e)}disconnectedCallback(...e){this.getFunc("REMOVE",e)}}class te{constructor(e,r){r=r||{},a.assign(this,{name:e,config:r,tables:[],Store:{}}),t.StoreList[e]=this}open(e){var r=this;return ne.Async(((s,a)=>{let n=M.open(r.name,r.version);t.once(n,"error",(async e=>{throw e})),t.once(n,"upgradeneeded",e||(e=>{let t=e.target.result;ne.toArr(r.config,(e=>{var[r,s]=e;if(!t.objectStoreNames.contains(r)){var a=t.createObjectStore(r);ne.toArr(s,(e=>{let{key:t,options:r}=e;r.options?a.createIndex(t,r.keyPath,r.options):a.createIndex(t,t,r||{unique:!1})}))}}))})),t.once(n,Y[0],(async t=>{let a=t.target.result;return r.tables=ne.toArr(a.objectStoreNames),r.version=a.version+1,r.check(r.config,r.tables).length>0?(a.close(),s(r.open(e))):(r.Store={},s(a))}))}))}check(e,t){return e=ne.toArr(e),t=ne.toArr(t),e.filter((e=>!t.includes(e[0])))}table(e){var t=this;return t.Store[e]||(t.Store[e]=new re(e,t)),t.Store[e]}async getTable(e,t){var r=this;r.config[e]||(r.config[e]=t||{}),r.db||(r.db=r.open());var s=await r.db;return r.check(r.config,r.tables).length>0&&(r.version+=1,s.close(),r.db=r.open(),s=await r.db),s}transaction(e,t,r){return r?r.transaction([e],t?N:"readwrite").objectStore(e):ne.Async((async r=>r(this.transaction(e,t,await this.getTable(e)))))}async clear(){var e=this;return e.db&&(await e.db).close(),e.db=N,M.deleteDatabase(e.name)}async delete(e){var t=this;t.db||ne.toArr(await M.databases(),(e=>{t.name===e.name&&(t.version=e.version+1)})),t.db=t.open((t=>{let r=t.target.result;X.log(1),ne.str(e)&&(e=[e]),ne.toArr(e,(e=>r.deleteObjectStore(e)))}))}}class re{constructor(e,t,r){a.assign(this,{table:e,IDB:t,opt:r,getDB:()=>t.getTable(e,r)})}async load(e,t){return ne.await(e)&&(e=await e),this.success(e.get(t))}async save(e,t,r){return ne.await(e)&&(e=await e),this.success(e.put(r,t))}success(e,r){return ne.Async((s=>t.on(e,Y[0],(e=>{var t=this.result;r?r(s,t):s(t)}))))}async transaction(e){var t=this;return t.IDB.transaction(t.table,e,await t.getDB())}get read(){return this.transaction(!0)}get write(){return this.transaction(!1)}getCursor(e,t){var r={};return this.success(e,((e,s)=>{if(s){if(ne.func(t))return t(e,s);var{primaryKey:a,key:n,value:i}=s;i?ne.str(t)?i&&i[t]&&(r[a]=i[t]):r[a]=i:r[a]=n,s.continue()}else e(r)}))}async get(e,r,s){var a=this,n=a.read;if(ne.str(e)){let y=await a.load(n,e);if(ne.obj(y)&&y.contents){var{contents:i,type:o,tag:l,filesize:p,filetype:u,filename:d,version:g}=y;if(r&&g&&r!=g)return;if(o==E.name)i=t.docElm(i),l&&(i=t.$(l,i));else if(!ne.str(i)&&p>t.maxsize&&i.length>0&&i.length!=p){ne.blob(i)&&(i.name&&(d=i.name),i.type&&(u=i.type));var m=e.split(t.part)[0];i=await ne.Async(ne.toArr(p/t.maxsize+1).map((async(r,s)=>{let o=m;return s>0&&(o+=t.part+s),e==o?i:(await a.load(n,o)).contents}))),i=ne.File(i,d||e,u,y.timestamp),o!=c.name&&(i=await ne.U8(i))}if(s)return i;y.contents=i}return y}if(ne.array(e))return ne.toObj(ne.Async(e.map((async e=>[e,await a.load(n,e)]))))}async put(e,r){var s=this,n=await s.write;if(e||ne.toArr(n.indexNames,(t=>{!e&&r[t]&&(e=r[t])})),ne.obj(r)&&r.contents){var{contents:i,filesize:o,filetype:c}=r;if(i&&(o||(o=i.size||i.length),c||(c=i.type||ie.getMime("*")),o&&o>t.maxsize))return delete r.contents,ne.Async(ne.toArr(o/t.maxsize+1).map((async(l,p)=>{let u=e;p>0&&(u+=t.part+p);var d=p*t.maxsize,g=await ne.U8(i.slice(d,o-d>=t.maxsize?d+t.maxsize:o));return s.save(n,u,a.assign({contents:g,filesize:o,filetype:c,timestamp:t.date},r))})))}return s.save(n,e,r)}async putdata(e,r,s,n){let i=a.assign({contents:r,timestamp:t.date},n);return s&&(i.version=s),this.put(e,i)}async getdata(e,t){return this.get(e,t,!0)}async delete(e){var t=this,r=await t.write;return ne.str(e)?t.success(r.delete(e)):ne.array(e)?ne.Async(ne.toArr(e).map((e=>t.success(r.delete(e),(t=>e))))):void 0}async remove(e){let r=this,s=await r.load(r.read,e);if(ne.obj(s)){var{filesize:a}=s;if(a&&a>t.maxsize)return r.delete(ne.toArr(a/t.maxsize+1).map(((r,s)=>{let a=e.split(t.part)[0];return s>0&&(a+=t.part+s),a})))}return r.delete(e)}async clear(){return this.success((await this.write).clear())}async count(e){return this.success((await this.read).count(e))}async all(e,t){return this.success((await this.read).getAll(e,t))}async keys(e,t){return this.success((await this.read).getAllKeys(e,t))}async key(e){return this.success((await this.read).getKey(e))}index(e){var t=this;return new class{get request(){return ne.Async((async r=>r((await t.read).index(e))))}async cursor(e,r,s){return t.cursor(e,r,s,this.request)}async keys(e,r,s){return t.keyCursor(e,r,s,this.request)}get(e){return t.load(this.request,e)}}}async cursor(e,t,r,s){return s||(s=this.read),this.getCursor((await s).openCursor(t,r),e)}async keyCursor(e,t,r,s){return s||(s=this.read),this.getCursor((await s).openKeyCursor(t,r),e)}}class se{ispack=/(zip|rar|7z)$/;constructor(e){ne.str(e)?this.url=e:a.assign(this,e),this.success&&this.done(this.success)}async done(e){var r,s,a=this,{url:i,type:l,libjs:p,store:u,key:d,unpack:g,filename:m,cancel:y,onLine:h,option:f,version:b,error:w,ispack:A}=a,x=ie.getname(i)||"index.html",j=t=>ne.func(e)?e(t,s):t,L=async()=>{if(S&&S.contents){var{filename:e,fileext:t,contents:r,type:s,password:a}=S;if("unpack"==s){var n={contents:r,Name:e,ext:t,onprogress:this.progress};a&&(n.password=a),S=await new ae(n).done()}else S=r}return j(S)};d=d||x,m=m||x,p&&(A.test(d)&&(d=t.LibPad+d.replace(A,"js"),g=!0),u=t.LibStore);var F=ne.IF(u,te)?u:t.getTable(u),S=F&&await F.get(d,b);if(S&&!h)return L();var C=await a.response;if(ne.nil(C)==N)return L();(s=ie.FilterHeader(ne.toObj(C.headers)||{})).filename||(s.filename=m);var T,{url:i,status:z,statusText:R}=C,{filetype:I,filesize:P,password:M}=s;if(M&&(a.password=M),ne.exends(s,{url:i,status:z,statusText:R}),l==ne.NN(v.head))return y(C),j(s);if(S){if(!S.filesize||P==S.filesize)return y(C),L();S=N}if(200!=C.status)return I==ie.getMime(texts[1])?s.result=await C.json():a.cancel(C),T=R,w&&w(T,s),ne.func(e)?e():N;if(P=(r=await a.steam(C,s)).size,l!=ne.L(o)?(r=await ne.U8(r),l&&(r=ne.decode(r),l=n.name),l==t.ts[0]?(r=ne.Json(r),l=t.ts[1]):l!=t.ts[0]&&s.type!=v.contentType||(l=E.name,r=t.docElm(r))):l=c.name,f=ne.assign(f,{timestamp:t.date,filename:m,filesize:P,filetype:I,type:l}),b&&(f.version=b),(ne.u8buf(r)||ne.blob(r))&&g){var k=await this.onUpack(r,f,d,F);if(k)return j(k)}return r?(F&&(f.contents=r,F.put(d,f)),j(r)):void 0}onUpack(e,r,s,n){return ne.Async((async i=>{var o=await ie.CheckExt(e);if(this.ispack.test(o)){var l,u=new ae({contents:e,Name:r.filename,ext:o,password:this.password,onprogress:this.progress}),d=await u.done(),g=0;if(ne.obj(d)&&(await ne.Async(ne.toArr(d).map((e=>{var[a,i]=e;if(this.libjs){a=ie.getname(a);var o=ie.getMime(a),u=t.LibPad+a;i=this.reBuf(i,this.unbuf,a,o),n.put(u,{contents:i,filename:a,filesize:i.byteLength,filetype:o,type:ne.blob(i)?c.name:ne.blob(i)?p.name:this.unbuf,version:r.version}),u==s&&(l=i)}else g+=i.byteLength,d[a]=this.reBuf(i,this.unbuf)}))),l))return i(l);e&&g&&(n&&(g>t.maxsize?(a.assign(r,{contents:e,fileext:o,type:"unpack"}),u.password&&(r.password=u.password),await n.put(s,r)):(e=null,a.assign(r,{contents:d,fileext:o,type:G.name}),await n.put(s,r))),i(d))}}))}cancel(e){e.body&&e.body.cancel()}async steam(e,t){var{body:r}=e;if(!r||!r.getReader)return e.blob();var{filename:s,type:a,length:n}=t;let i=0,o=0,c=await r.getReader(),l=[];for(;;){const{done:e,value:t}=await c.read();if(e)break;if(o=t.length,i+=o,this.progress){let e=" ";e=n&&i<=n?ne.PER(i,n)+"%":`(${(i/1024).toFixed(1)}KB)`,this.progress(`${s||""} ${e}`,i,n,o)}l.push(t)}return ne.File(l,s,a,t["last-modified"])}reBuf(e,r,s,a){return r==t.ts[0]?e=ne.decode(e):r==t.ts[1]?e=ne.Json(ne.decode(e)):!r&&s&&(e=ne.File([e],s,a)),e}async getStore(e){return ne.IF(e,te)?e:t.getTable(e)}get response(){var{url:e,get:r,post:s,head:a,json:n,headers:i}=this;let o={headers:i||{}};return ne.exends(o,a),n?(s=ne.toJson(ARG.json),o.headers.Accept=ie.getMime(t.ts[1])):s&&(s=ne.post(ARG.post)),s&&(o.method="POST",o.body=s),O(ne.get(e,r),o)}}class ae{constructor(e){ne.obj(e)?a.assign(this,e):this.contents=e}async done(e){var{ext:t,contents:r}=this;t||(t=await ie.CheckExt(r));var s=/zip$/.test(t)&&await this.zip()||await this.rar(t)||await this.extractor(t)||await ne.U8(r);return e?e(s):s}progress(e,t,r){this.onprogress&&this.onprogress(`unpack(${ne.PER(e,t)})${r||""}`)}async extractor(e){return ne.Async((async r=>{ie.getLibjs("extractor-new.min.zip").catch((e=>r())).then((s=>{if(!s)return r();var a,n,i=new Worker(s),c={},l=0;i.onmessage=e=>{var{file:t,data:s,size:u,end:d,total:g,error:m}=e.data;g?n=g:d?(ne.Async(ne.toArr(c).map((async e=>{var[t,r]=e;return[t,r.length?await ne.U8(new o(r)):new p]}))).then((e=>{e=e.length?ne.toObj(e):N,r(e)})),i.terminate()):t&&!/\/$/.test(t)?(c[t]=[],a=t):s&&a?(l+=u,c[a].push(s)):m&&!c[a].length&&delete c[a],a&&this.progress(l,n,a)},i.onerror=e=>{i.terminate(),r()},i.onmessageerror=i.onerror,i.postMessage({filename:this.Name||"test."+(e||"zip"),data:this.contents,DB_NAME:t.DB_NAME,DB_TABLE:t.LibStore,DB_FILE:t.LibPad+"extractor-new.wasm"})}))}))}async rar(e){var r=t.unrarsrc;e&&/7z$/.test(e)&&(r=t.un7zsrc);var{contents:s,password:a,onprogress:n}=this;s=await ne.U8(s);let i=await ie.getLibjs(r,n);return ne.Async((e=>{let t,r=new Worker(i),n=e=>r.terminate();r.onmessage=s=>{if(ne.obj(s.data)){var{t:i,data:o,file:c,total:l,current:p,name:u}=s.data;if(1==i)e(t||N);else{if(2==i)return!t&&(t={}),o&&(t[c]=o);if(4==i)return l>0&&l>=p&&this.progress(p,l,u||c);if(-1===i){if(a=$("Enter password.",a||""))return r.postMessage({password:a});e(N)}}n()}},r.onerror=t=>{e(N),n()},r.onmessageerror=r.onerror,r.postMessage({contents:s,password:a})}))}async getEntries(e,t,r){if(ne.none(t)){var s,a=e.filter(((e,t)=>{if(ne.none(s)&&e.encrypted)return s=t,!0}))[0];if(a)return(a=await this.getEncrypted(a,this.password))?(e.splice(s,1),await this.getEntries(e,a[0],a[1])):N}return ne.toObj((r?[r]:[]).concat(await ne.Async(e.filter((e=>!e.directory)).map((async e=>[e.filename,await this.getData(e,t)])))))}async getData(e,t){return e.getData(new zip.Uint8ArrayWriter,{password:t})}async getEncrypted(e,t){var r=await ne.Async((r=>{this.getData(e,t).catch((r=>(t=$("Enter password.",t))?this.getEncrypted(e,t):N)).then((e=>r(e)))}));return this.password=t,ne.u8buf(r)||ne.blob(r)?[t,[e.filename,r]]:r}async zip(){var{contents:e}=this;typeof r.zip===ne.TP()&&await t.loadLibjs(t.zipsrc,this.onprogress),ne.blob(e)||(e=new o([e.buffer||e],{type:ie.getMime("*")}));var s=new zip.ZipReader(new zip.BlobReader(e)),a=await s.getEntries();if(!ne.empty(a))return await this.getEntries(a)}}const ne=new class{constructor(){let e=this;a.assign(e,{O:t=>e.CS(t)==i?e[t]:t,B:(e,t)=>e&&e.bind(t),IF:(t,r)=>t instanceof e.O(r),IC:(t,r)=>e.CS(t)===e.O(r),TP:e=>typeof e,N:t=>(t=e.O(t))&&t.name||e.CS(t)&&e.CS(t).name||e.TP(t),NC:t=>e.LC(e.N(t)),R:(t,...r)=>Reflect.construct(e.O(t),r),H:(e,t)=>t&&e.hasOwnProperty(t)||!1,L:t=>((t=e.O(t))&&e.ST(t)||e.N(t)||e.TS(t)).replace(/^(\w)/,(t=>e.LC(t))),C:t=>e.CS(e.O(t)),CS:e=>null!=e&&e!=N&&e.constructor,CP:e=>null!=e&&e!=N&&e.prototype||e,DP:(e,t)=>Reflect.deleteProperty(e,t),FE:(e,t)=>t&&e.forEach&&e.forEach(t)||e,FM:(e,t)=>t&&e.map&&e.map(t)||e,TS:e=>e.toString(),NN:t=>e.LC(t.nodeName),ST:t=>e.LC(t[j.toStringTag]||""),LC:e=>e&&e.toLowerCase(),UC:e=>e&&e.toUpperCase(),dE:e=>(e||v).documentElement,dElm:(t,r)=>e.dE((new B).parseFromString(t,r)),elm:t=>e.IF(t,E),node:t=>e.IF(t,q),nodelist:t=>e.IF(t,G),isDoc:t=>e.IF(t,Z),await:t=>e.IF(t,g),blob:t=>e.IF(t,o),file:t=>e.IF(t,c),evt:t=>e.IF(t,z),keyevt:t=>e.IF(t,K),func:t=>e.IF(t,u)&&!e.isClass(t),isClass:e=>/^class\s/.test(u.prototype.toString.call(e)),array:e=>s.isArray(e),obj:t=>e.IC(t,a),buf:t=>e.IC(t,l),u8obj:t=>e.IC(t,p),u8buf:t=>e.u8obj(t),str:t=>e.IC(t,n),cURL:e=>y.createObjectURL(e),rURL:e=>y.revokeObjectURL(e),bool:t=>e.IC(t,d),num:t=>e.IC(t,i),null:e=>null===e,none:t=>e.TP(t)==e.TP(),nil:t=>e.null(t)||e.none(t),Arr:e=>new s(e),ArrFrom:e=>s.from(e),U8:t=>e.u8buf(t)?t:e.blob(t)?e.Async((async r=>r(e.U8(await t[e.L(l)]())))):new p(t.buffer||t),Buf16str:t=>e.toArr(t).map((t=>e.To16(t))).join(""),To16:e=>e.toString(16).padStart(2,0).toLocaleUpperCase(),ArrTest:(t,r)=>e.toArr(t).filter((e=>e[1].test(r)))[0],decode:(e,t)=>new b(t).decode(e),encode:e=>(new w).encode(e),isForm:t=>e.IF(t,m),setForm:e=>new m(e),setParam:e=>new h(e),Int:t=>e.IntVal(t),IntVal:(e,t)=>L(e,t),PER:(t,...r)=>e.Int(100*t/r[0]).toFixed(0)+(r[1]?"":"%"),Async:(t,r)=>e.array(t)?r?g.allSettled(t):g.all(t):e.func(t)?new g(t):null,$:(e,t)=>(t||v).querySelector(e)||N,$$:(e,t)=>(t||v).querySelectorAll(e)||N,$c:e=>v.createElement(e),RegRe:(t,r)=>(e.toArr(r,(e=>t=t.replace(new A(`{${e[0]}}`,"g"),e[1]))),t),setStyle:(t,r)=>(e.toArr(r,(r=>e.reProp(t.style||t,r[0],r[1]))),t),getAttr:(t,r)=>e.B(e.CP(Element).getAttribute,t)(r),setAttr:(t,r,s)=>s?e.B(e.CP(Element).setAttribute,t)(r,s):e.getAttr(t,r),reAttr:(t,r,s)=>e.nil(s)?e.B(e.CP(Element).removeAttribute,t)(r):e.setAttr(t,r,s),getProp:(t,r)=>e.B(e.CP(C).getPropertyValue,t)(r),setProp:(t,r,s)=>s?e.B(e.CP(C).setProperty,t)(r,s):e.getProp(t,r),reProp:(t,r,s)=>s?e.setProp(t,r,s):e.B(e.CP(C).removeProperty,t)(r),Attr:(t,...r)=>e.obj(r[0])?e.toArr(r[0],(r=>e.Attr(t,r[0],r[1]))):r[0]?e.setAttr(t,...r):e.toObj(t.attributes),Call:(e,...t)=>Reflect.apply(e,t.shift(),t),Apply:(t,r,s)=>(e.str(t)&&s&&(t=s[t]),e.func(t)&&Reflect.apply(t,s,r)),on:(t,...r)=>t&&e.Apply(F,r,t),un:(t,...r)=>t&&e.Apply(S,r,t),EachNext:(t,r)=>!(r=[])||e.Next(t,(t=>r.push(e.num(t[0])?t[1]:t)))||r,Next(e,t){e.entries&&(e=e.entries());let r=e.next();for(;!r.done;)t(r.value),r=e.next()},inArr:(t,...r)=>e.Item(r,(e=>t.includes(e)))||!1,inClass:(t,...r)=>e.Item(r,(r=>e.IF(r,t)))||!1,Item(e,t){for(let r=0;r<e.length;r++){let s=t(e.item&&e.item(r)||e[r]);if(s)return s}},EachItem:(t,r)=>!(r=[])||e.Item(t,(s=>{e.IF(t,C)?r.push([s,e.getProp(t,s)]):s.value?r.push([s.name,s.value]):r.push(s)}))||r,EachValue:(t,r)=>!(r=[])||!e.FE(t,((e,t)=>r.push([t,e])))||r,FromEntries:t=>a.fromEntries(e.toArr(t).map(((t,r)=>e.array(t)&&2==t.length?t:[r,t]))),getEntries:t=>e.obj(t)?e.Entries(t):e.num(t)||t.byteLength?e.ArrFrom(e.U8(t.buffer||t)):e.func(t.entries)?e.EachNext(t):t.item?e.EachItem(t):e.ArrFrom(t),Entries:(t,r)=>e.FE(a.entries(t),r),toJson:t=>P.stringify(e.Json(t)),define:(t,r,s,n,i)=>a.defineProperty(t,r,n?{get:e.func(s)?s:()=>s,configurable:1==i}:s),defines:(t,r,s,n)=>s?e.toArr(r,(r=>e.define(t,r[0],r[1],1,n))):a.defineProperties(t,r),AsyncTry:(t,r)=>e.Async((async s=>{t().catch((async a=>{if(r(a))return s(null);s(await e.AsyncTry(t,r))})).then((e=>s(e)))})),assign:(...t)=>(e.array(t[0])&&(t=[].concat(...t)),a.assign({},...t)),exends:(t,r,s)=>s?(e.toArr(s,(e=>t[e]=r[e])),r):a.assign(t,r),empty:t=>!t||0==t||(e.str(t)?0==t.trim().length:0==e.toArr(t).length),Json:t=>(e.u8buf(t)&&(t=e.decode(t)),e.str(t)?new u("return "+t)():t),progress(t,...r){if(t)return r[0]+=" "+e.PER(r[1],r[2]),e.Apply(t,r,r[3])},File:(t,r,s,a)=>new c(t,r,{type:s,lastModified:a&&e.Date(a).getTime()}),Date:t=>new T(e.IntVal(t)||t)}),t.mobile=!e.none(v.ontouchend)}post(e){let t=ne.isForm(e)?e:ne.setForm(ne.elm(e)?e:ne.str(e)?ne.$(e):N);return ne.obj(e)&&ne.toArr(e,(e=>t.append(e[0],e[1]))),t}get(e,...t){let r=e.split("?"),s=r[1]&&r[1].split("#")[0]||"",a=ne.toArr(ne.toObj(ne.setParam(s+"&"+t.map((e=>ne.obj(e)?ne.setParam(e):e)).join("&")))).map((e=>e[0]+"="+e[1])).join("&").replace(/=&/g,"&");return r[0]+(a?"?"+a:"")}toObj(e){return e?ne.obj(e)?e:ne.FromEntries(e):{}}toArr(e,t){if(!e)return[];let r=ne.getEntries(e);return ne.func(t)?ne.FE(r,t):r}},ie=new class{Libjs={};ext16={"7z":/^377ABCAF271C/,rar:/^52617221/,zip:/^504B0304/,png:/^89504E470D0A1A0A/,gif:/^47494638(3761|3961)/,jpg:/^FFD8FFE000104A464946/,webp:/^52494646\w{8}57454250/,pdf:/^255044462D312E/,bmp:/^424D\w{4}0{8}/};exttype={text:["css","scss","sass","html","htm","xml"],"text/javascript":["js"],"text/css":["style"],"text/html":["htm","php"],"text/plain":["txt"],"text/xml":["vml"],image:["jpg","jpeg","png","gif","webp","avif","apng","heic"],font:["woff","woff2","ttf","otf"],"image/svg+xml":["svg"],"application/octet-stream":["*"],application:["pdf","json"],"application/x-zip-compressed":["zip"],"application/x-rar-compressed":["rar"],"application/x-7z-compressed":["7z"]};CheckExt(e){let t=e.slice(0,16),r=ne.blob(t)?ne.U8(t):ne.str(t)?ne.encode(t):t;return ne.await(r)?ne.Async((async e=>{e(ie.mimeHead(await r))})):ie.mimeHead(r)}async getLibjs(e,r,s,a,n){let i=ie.getname(e),o=i.replace(/\.zip$/,".js");if(ie.Libjs[i])return ie.Libjs[i];if(ie.Libjs[o])return ie.Libjs[o];s=s||t.version;let c=await t.getTable(t.LibStore).getdata(t.LibPad+o,s);return c||(/\.zip$/.test(i)&&await t.loadZip(r),c=await t.FetchItem({url:ie.getlibpath(e)+"?"+t.time,libjs:!0,version:s,progress:r,Filter:n,decode:a,unbuf:!!a&&t.ts[0]})),/json$/.test(o)?ie.Libjs[o]=c:c&&(ne.obj(c)?ne.toArr(c,(e=>ie.Libjs[e[0]]=e[1]&&ie.URL(e[1],e[0]))):ie.Libjs[o]=ie.URL(c,o)),c=null,ie.Libjs[o]}URL(e,t){return ne.str(e)&&/^(blob|http|\/?\w+\/)[^\n]*$/i.test(e)?e:ne.cURL(ne.blob(e)?e:new o([e],{type:ie.getMime(t||ne.u8buf(e)&&ie.CheckExt(e)||"js")}))}reURL(e){return ne.rURL(e)}getlibpath(e){let t=/^[\w\-\.]+$/.test(e)?"lib/":"";return ie.getpath(t+e)}getname(e){let t=(e||"").split("/").pop().split("?")[0].split("#")[0];return t||(e=e.match(/\/\?([\w\-\_\.]+?\.[a-z0-9A-Z]+)\&?/))&&(t=e[1]),t||""}getpath(e){return/^(\/|https?:\/\/|static\/js\/|data\/|assets|blob\:|\.|\/)/.test(e)?e:t.JSpath+e}getExt(e){return ne.LC(ie.getname(e).split(".").pop())}getKeyName(e){let t=ie.getname(e).split(".");return t.slice(0,t.length>1?t.length-1:1).join(".")}getMime(e,t){let r;return/^\w+\/\w+$/.test(e)||ie.exttype[e]?r=e:(ie.extlist||(ie.extlist=ne.assign(ne.toArr(ie.exttype).map((e=>ne.toObj(ne.toArr(e[1]).map((t=>{let r=e[0];return/\//.test(r)||(delete ie.exttype[r],r+="/"+t,ie.exttype[r]=!0),[t,r]}))))))),r=ie.extlist[ie.getExt(e)]||ie.extlist["*"]),t&&/(text|javascript|xml|json)/.test(r)?r+";chartset=utf8":r}getType(e){return(e=ie.getMime(e)).split("/").pop()}FilterHeader(e){return ne.toArr(e,(t=>{if(/content-/.test(t[0])){let r=t[0].replace("content-",""),s=decodeURI(t[1]);switch(isFinite(s)&&(s=ne.IntVal(s)),r){case"disposition":let t=s.match(/^attachment;\s*filename=[\"\']+?(.+)[\"\']+?$/i);t&&t[1]&&(e.filename=decodeURI(t[1]));break;case"length":e.filesize=s;case"password":e[r]=s;break;case"type":s=ne.LC(s);let a=s.split(";");e.filetype=s,e[r]=a[0].trim(),a[1]&&(e.charset=ne.LC(a[1].split("=").pop().trim()));break}}})),e}ajaxHeader(e){return ie.FilterHeader(ne.toObj((e.getAllResponseHeaders()||"").trim().split(/[\r\n]+/).map((e=>{let t=e.split(": ");return[t.shift(),t.join(": ")]})).concat([["status",e.status],["statusText",e.statusText],["url",e.responseURL]])))}HtmltoStr(e){ne.elm(e)&&!e.contents&&(e={contents:e});let t=e&&e.contents;return ne.elm(t)&&(e.contents=t.outerHTML,e.tag=ne.NN(v.body),e.type=E.name),e}mimeHead(e){let t=ne.Buf16str(e),r=ne.ArrTest(ie.ext16,t);return r&&r[0]?r[0]:""}};!function(){var{language:e,serviceWorker:s}=navigator,i=v.currentScript,o=i&&i.src.split("?"),c=o&&o[0].split("/").slice(0,-1).join("/")+"/",l=ne.LC(e).split("-");c&&(c=c.replace("static/","")),"zh"==l[0]&&("cn"==l[1]?l[1]="hans":"hk"!=l[1]&&(l[1]="hant")),a.assign(t,Q,{JSpath:c,ROOT:c&&c.replace("assets/js/","")||H.pathname,langName:l[0],i18nName:l.join("-"),charset:ne.LC(v.characterSet),language:e}),t.ts=[ne.L(f),ne.L(P),ie.getType(t.mime),t.mime,ne.L(n)],ne.defines(t,{I:ne,F:ie,date:()=>new T,time:()=>T.now(),rand:()=>Math.random(),randNum:()=>ne.IntVal(Math.random().toString().slice(2))},1),s&&(t.setServiceWorker(),a.assign(t,{async openServiceWorker(e){s.register(e).then((e=>!t.sw_install&&t.setServiceWorker()))},clearWorker(e){s.getRegistrations().then((t=>t.forEach((t=>{t.active&&(e&&t.active.scriptURL.includes(e)?t.unregister():e||t.unregister())}))))}})),r.onerror=(e,t,r,s,a)=>U(e+r+t)}();var oe={on(e,r,s,a){return t.on(this,e,r,s,a)},un(e,r,s,a){return t.un(this,e,r,s,a)},once(e,r,s,a){return t.once(this,e,r,s,a)}};a.assign(q.prototype,oe),ne.defines(r,{Nenge:()=>t},1)}));